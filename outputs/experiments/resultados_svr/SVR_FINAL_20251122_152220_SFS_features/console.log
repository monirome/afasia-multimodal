[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] SVR COMPLETO FINAL - SFS FEATURES
[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] Output: /lhome/ext/upc150/upc1503/afasia_cat/codigos_julio2025/outputs/experiments/resultados_svr/SVR_FINAL_20251122_152220_SFS_features
[2025-11-22 15:22:20] [INFO] POS-LM method: none
[2025-11-22 15:22:20] [INFO] SHAP disponible: SI
[2025-11-22 15:22:20] [INFO] 
======================================================================
[2025-11-22 15:22:20] [INFO] CARGANDO DATOS
[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] Total registros: 506
[2025-11-22 15:22:20] [INFO] 
Pacientes ES (TCU) antes del parche:
[2025-11-22 15:22:20] [INFO] 
patient_id language group   QA
    TCU02a       es   pwa 77.3
    TCU04a       es   pwa 83.8
    TCU06a       es   NaN 62.6
    TCU10a       es   NaN 77.6
[2025-11-22 15:22:20] [INFO] 
Pacientes ES (TCU) después del parche:
[2025-11-22 15:22:20] [INFO] 
patient_id language group   QA
    TCU02a       es   pwa 77.3
    TCU04a       es   pwa 83.8
    TCU06a       es   pwa 62.6
    TCU10a       es   pwa 77.6
[2025-11-22 15:22:20] [INFO] Con QA valido: 506
[2025-11-22 15:22:20] [INFO] 
Distribucion por idioma:
[2025-11-22 15:22:20] [INFO]   en: 502
[2025-11-22 15:22:20] [INFO]   es: 4
[2025-11-22 15:22:20] [INFO] 
======================================================================
[2025-11-22 15:22:20] [INFO] SPLIT
[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] 
Split:
[2025-11-22 15:22:20] [INFO]   PWA:     423
[2025-11-22 15:22:20] [INFO]   Control: 70
[2025-11-22 15:22:20] [WARNING] 
NO se encontró columna de sub-dataset (subdataset_paper / subdataset / subset). Se usará GroupKFold sin estratificación por sub-dataset.
[2025-11-22 15:22:20] [INFO] 
Por idioma (PWA):
[2025-11-22 15:22:20] [INFO]   EN (train): 419
[2025-11-22 15:22:20] [INFO]   ES (eval):  4
[2025-11-22 15:22:20] [INFO] 
======================================================================
[2025-11-22 15:22:20] [INFO] FEATURES
[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] 
======================================================================
[2025-11-22 15:22:20] [INFO] SEQUENTIAL FORWARD SELECTION
[2025-11-22 15:22:20] [INFO] ======================================================================
[2025-11-22 15:22:20] [INFO] 
Iniciando SFS...

[2025-11-22 15:22:32] [INFO] 
======================================================================
[2025-11-22 15:22:32] [INFO] RESULTADOS SFS
[2025-11-22 15:22:32] [INFO] ======================================================================
[2025-11-22 15:22:32] [INFO] Número óptimo: 13 features
[2025-11-22 15:22:32] [INFO] MAE: 14.024
[2025-11-22 15:22:32] [INFO] 
Features:
[2025-11-22 15:22:32] [INFO]   DEN:   7
[2025-11-22 15:22:32] [INFO]   DYS:   5
[2025-11-22 15:22:32] [INFO]   LEX:   1
[2025-11-22 15:22:32] [INFO]   POSLM: 0
[2025-11-22 15:22:32] [INFO]   TOTAL: 13
[2025-11-22 15:22:32] [INFO] 
======================================================================
[2025-11-22 15:22:32] [INFO] CROSS-VALIDATION (EN) - GroupKFold por paciente (sin estratificación por sub-dataset)
[2025-11-22 15:22:32] [INFO] ======================================================================
[2025-11-22 15:22:32] [INFO] 
  Fold 1/4:
[2025-11-22 15:22:32] [INFO]     MAE: 13.812
[2025-11-22 15:22:32] [INFO] 
  Fold 2/4:
[2025-11-22 15:22:33] [INFO]     MAE: 12.394
[2025-11-22 15:22:33] [INFO] 
  Fold 3/4:
[2025-11-22 15:22:33] [INFO]     MAE: 11.856
[2025-11-22 15:22:33] [INFO] 
  Fold 4/4:
[2025-11-22 15:22:34] [INFO]     MAE: 13.153
[2025-11-22 15:22:34] [INFO] 
======================================================================
[2025-11-22 15:22:34] [INFO] EVALUACION: CV_PWA
[2025-11-22 15:22:34] [INFO] ======================================================================
[2025-11-22 15:22:34] [INFO] Metricas de regresion:
[2025-11-22 15:22:34] [INFO]   MAE:        12.803
[2025-11-22 15:22:34] [INFO]   RMSE:       17.821
[2025-11-22 15:22:34] [INFO]   R²:         0.437
[2025-11-22 15:22:34] [INFO]   Pearson r:  0.682 (p=0.0000)
[2025-11-22 15:22:34] [INFO]   Spearman:   0.700 (p=0.0000)
[2025-11-22 15:22:34] [INFO] 
Accuracy por distancia:
[2025-11-22 15:22:34] [INFO]   Acc@1:  6.92%
[2025-11-22 15:22:34] [INFO]   Acc@5:  29.36%
[2025-11-22 15:22:34] [INFO]   Acc@10: 55.61%
[2025-11-22 15:22:34] [INFO]   Exact:  0.00%
[2025-11-22 15:22:34] [INFO] 
Clasificacion por severidad:
[2025-11-22 15:22:34] [INFO]   Accuracy: 57.52%
[2025-11-22 15:22:34] [INFO] 
  Por clase:
[2025-11-22 15:22:34] [INFO]     Very Severe: Prec=85.71%, Rec=13.64%, F1=23.53%
[2025-11-22 15:22:34] [INFO]     Severe: Prec=29.03%, Rec=32.73%, F1=30.77%
[2025-11-22 15:22:34] [INFO]     Moderate: Prec=53.03%, Rec=67.31%, F1=59.32%
[2025-11-22 15:22:34] [INFO]     Mild: Prec=73.68%, Rec=68.29%, F1=70.89%
[2025-11-22 15:22:34] [INFO] 
Generando graficos...
[2025-11-22 15:22:34] [INFO] Guardados: CV_PWA_*.csv/png
[2025-11-22 15:22:34] [INFO] 
======================================================================
[2025-11-22 15:22:34] [INFO] CALIBRACION
[2025-11-22 15:22:34] [INFO] ======================================================================
[2025-11-22 15:22:34] [INFO] 
======================================================================
[2025-11-22 15:22:34] [INFO] EVALUACION: CV_PWA_CALIBRATED
[2025-11-22 15:22:34] [INFO] ======================================================================
[2025-11-22 15:22:34] [INFO] Metricas de regresion:
[2025-11-22 15:22:34] [INFO]   MAE:        12.311
[2025-11-22 15:22:34] [INFO]   RMSE:       16.389
[2025-11-22 15:22:34] [INFO]   R²:         0.524
[2025-11-22 15:22:34] [INFO]   Pearson r:  0.724 (p=0.0000)
[2025-11-22 15:22:34] [INFO]   Spearman:   0.720 (p=0.0000)
[2025-11-22 15:22:34] [INFO] 
Accuracy por distancia:
[2025-11-22 15:22:34] [INFO]   Acc@1:  5.25%
[2025-11-22 15:22:34] [INFO]   Acc@5:  26.73%
[2025-11-22 15:22:34] [INFO]   Acc@10: 52.74%
[2025-11-22 15:22:34] [INFO]   Exact:  0.00%
[2025-11-22 15:22:34] [INFO] 
Clasificacion por severidad:
[2025-11-22 15:22:34] [INFO]   Accuracy: 58.95%
[2025-11-22 15:22:34] [INFO] 
  Por clase:
[2025-11-22 15:22:34] [INFO]     Very Severe: Prec=90.00%, Rec=20.45%, F1=33.33%
[2025-11-22 15:22:34] [INFO]     Severe: Prec=31.25%, Rec=36.36%, F1=33.61%
[2025-11-22 15:22:34] [INFO]     Moderate: Prec=54.75%, Rec=62.82%, F1=58.51%
[2025-11-22 15:22:34] [INFO]     Mild: Prec=72.29%, Rec=73.17%, F1=72.73%
[2025-11-22 15:22:34] [INFO] 
Generando graficos...
[2025-11-22 15:22:35] [INFO] Guardados: CV_PWA_CALIBRATED_*.csv/png
[2025-11-22 15:22:35] [INFO] 
======================================================================
[2025-11-22 15:22:35] [INFO] ANÁLISIS DE ERROR (Como Figura 6 del paper)
[2025-11-22 15:22:35] [INFO] ======================================================================
[2025-11-22 15:22:35] [INFO] 
======================================================================
[2025-11-22 15:22:35] [INFO] ANÁLISIS POR GRUPOS DE ERROR (Threshold=5.316)
[2025-11-22 15:22:35] [INFO] ======================================================================
[2025-11-22 15:22:35] [INFO] 
Grupo Low Errors:
[2025-11-22 15:22:35] [INFO]   N:          116
[2025-11-22 15:22:35] [INFO]   MAE:        2.65 ± 1.43
[2025-11-22 15:22:35] [INFO]   QA real:    67.9 ± 14.9
[2025-11-22 15:22:35] [INFO] 
Grupo High Errors:
[2025-11-22 15:22:35] [INFO]   N:          303
[2025-11-22 15:22:35] [INFO]   MAE:        16.01 ± 10.57
[2025-11-22 15:22:35] [INFO]   QA real:    62.3 ± 26.2
[2025-11-22 15:22:35] [INFO] 
Diferencia en QA real entre grupos:
[2025-11-22 15:22:35] [INFO]   t-statistic: 2.700
[2025-11-22 15:22:35] [INFO]   p-value:     0.0073
[2025-11-22 15:22:35] [INFO] 
Guardado: error_histogram.png, error_groups_analysis.csv
[2025-11-22 15:22:35] [INFO] 
======================================================================
[2025-11-22 15:22:35] [INFO] MODELO FINAL
[2025-11-22 15:22:35] [INFO] ======================================================================
[2025-11-22 15:22:35] [INFO] Entrenando con: 419 PWA EN + 70 Control
[2025-11-22 15:22:36] [INFO] Mejores parámetros:
[2025-11-22 15:22:36] [INFO]   svr__C: 10
[2025-11-22 15:22:36] [INFO]   svr__epsilon: 0.01
[2025-11-22 15:22:36] [INFO]   svr__gamma: scale
[2025-11-22 15:22:36] [INFO]   svr__kernel: rbf
[2025-11-22 15:22:36] [INFO] 
======================================================================
[2025-11-22 15:22:36] [INFO] INTERPRETABILIDAD
[2025-11-22 15:22:36] [INFO] ======================================================================
[2025-11-22 15:22:36] [INFO] 
======================================================================
[2025-11-22 15:22:36] [INFO] PERMUTATION IMPORTANCE
[2025-11-22 15:22:36] [INFO] ======================================================================
[2025-11-22 15:22:36] [INFO] Calculando (n_repeats=10)...
[2025-11-22 15:22:37] [INFO] 
Top 20 features:
[2025-11-22 15:22:37] [INFO]    1. lex_ttr                                  3.0088 +/- 0.2440
[2025-11-22 15:22:37] [INFO]    2. den_determiners                          2.6836 +/- 0.2186
[2025-11-22 15:22:37] [INFO]    3. den_function_words                       2.4122 +/- 0.1561
[2025-11-22 15:22:37] [INFO]    4. dys_fillers_per_word                     2.0895 +/- 0.1526
[2025-11-22 15:22:37] [INFO]    5. den_nouns                                1.8275 +/- 0.2160
[2025-11-22 15:22:37] [INFO]    6. den_words_utt_q1                         1.3353 +/- 0.1365
[2025-11-22 15:22:37] [INFO]    7. den_words_utt_p90                        1.3019 +/- 0.1414
[2025-11-22 15:22:37] [INFO]    8. dys_pauses_per_min                       1.1894 +/- 0.1521
[2025-11-22 15:22:37] [INFO]    9. dys_long_pauses_per_min                  1.1837 +/- 0.1773
[2025-11-22 15:22:37] [INFO]   10. den_phones_utt_max                       1.1395 +/- 0.1481
[2025-11-22 15:22:37] [INFO]   11. dys_short_pauses_per_min                 1.1250 +/- 0.1101
[2025-11-22 15:22:37] [INFO]   12. dys_long_pauses_per_word                 1.0432 +/- 0.1147
[2025-11-22 15:22:37] [INFO]   13. den_light_verbs                          0.9903 +/- 0.1287
[2025-11-22 15:22:37] [INFO] 
Guardado: feature_importance_permutation.csv/png
[2025-11-22 15:22:37] [INFO] 
======================================================================
[2025-11-22 15:22:37] [INFO] ANALISIS POR GRUPOS (Permutation)
[2025-11-22 15:22:37] [INFO] ======================================================================
[2025-11-22 15:22:37] [INFO] 
Importancia por grupo:
[2025-11-22 15:22:37] [INFO]   Grupo         Total      Media    Count    % Total
[2025-11-22 15:22:37] [INFO]   ------------------------------------------------------------
[2025-11-22 15:22:37] [INFO]   DEN         11.6903     1.6700        7      54.8%
[2025-11-22 15:22:37] [INFO]   DYS          6.6308     1.3262        5      31.1%
[2025-11-22 15:22:37] [INFO]   LEX          3.0088     3.0088        1      14.1%
[2025-11-22 15:22:37] [INFO] 
Guardado: feature_importance_by_group_permutation.csv/png
[2025-11-22 15:22:37] [INFO] 
======================================================================
[2025-11-22 15:22:37] [INFO] SHAP VALUES
[2025-11-22 15:22:37] [INFO] ======================================================================
[2025-11-22 15:22:37] [INFO] Calculando SHAP values...
[2025-11-22 15:22:37] [INFO]   Usando 100 samples random como background
[2025-11-22 15:22:37] [INFO]   Creando SHAP explainer...
[2025-11-22 15:22:37] [INFO]   Calculando SHAP para 83 samples de test...
[2025-11-22 15:27:53] [INFO] 
Top 20 features (SHAP):
[2025-11-22 15:27:53] [INFO]    1. den_determiners                          3.6521
[2025-11-22 15:27:53] [INFO]    2. lex_ttr                                  3.0014
[2025-11-22 15:27:53] [INFO]    3. den_function_words                       2.8082
[2025-11-22 15:27:53] [INFO]    4. dys_fillers_per_word                     2.5236
[2025-11-22 15:27:53] [INFO]    5. den_nouns                                1.6657
[2025-11-22 15:27:53] [INFO]    6. den_words_utt_p90                        1.4533
[2025-11-22 15:27:53] [INFO]    7. den_phones_utt_max                       1.4299
[2025-11-22 15:27:53] [INFO]    8. den_light_verbs                          1.0338
[2025-11-22 15:27:53] [INFO]    9. dys_long_pauses_per_word                 1.0118
[2025-11-22 15:27:53] [INFO]   10. dys_long_pauses_per_min                  0.8661
[2025-11-22 15:27:53] [INFO]   11. dys_pauses_per_min                       0.8297
[2025-11-22 15:27:53] [INFO]   12. den_words_utt_q1                         0.7183
[2025-11-22 15:27:53] [INFO]   13. dys_short_pauses_per_min                 0.6000
[2025-11-22 15:27:53] [INFO] 
Generando graficos SHAP...
[2025-11-22 15:27:54] [INFO]   Guardado: shap_summary_*.png
[2025-11-22 15:27:54] [INFO] Guardado: shap_values.csv, feature_importance_shap.csv
[2025-11-22 15:27:54] [INFO] 
======================================================================
[2025-11-22 15:27:54] [INFO] ANALISIS POR GRUPOS (SHAP)
[2025-11-22 15:27:54] [INFO] ======================================================================
[2025-11-22 15:27:54] [INFO] 
Importancia por grupo:
[2025-11-22 15:27:54] [INFO]   Grupo         Total      Media    Count    % Total
[2025-11-22 15:27:54] [INFO]   ------------------------------------------------------------
[2025-11-22 15:27:54] [INFO]   DEN         12.7613     1.8230        7      59.1%
[2025-11-22 15:27:54] [INFO]   DYS          5.8312     1.1662        5      27.0%
[2025-11-22 15:27:54] [INFO]   LEX          3.0014     3.0014        1      13.9%
[2025-11-22 15:27:54] [INFO] 
Guardado: feature_importance_by_group_shap.csv/png
[2025-11-22 15:27:54] [INFO] 
======================================================================
[2025-11-22 15:27:54] [INFO] EVALUACION ESPAÑOL
[2025-11-22 15:27:54] [INFO] ======================================================================
[2025-11-22 15:27:54] [INFO] Evaluando 4 pacientes españoles...
[2025-11-22 15:27:54] [INFO] 
======================================================================
[2025-11-22 15:27:54] [INFO] EVALUACION: EVAL_ES_RAW
[2025-11-22 15:27:54] [INFO] ======================================================================
[2025-11-22 15:27:54] [INFO] Metricas de regresion:
[2025-11-22 15:27:54] [INFO]   MAE:        13.223
[2025-11-22 15:27:54] [INFO]   RMSE:       15.768
[2025-11-22 15:27:54] [INFO]   R²:         -3.096
[2025-11-22 15:27:54] [INFO]   Pearson r:  0.490 (p=0.5098)
[2025-11-22 15:27:54] [INFO]   Spearman:   0.400 (p=0.6000)
[2025-11-22 15:27:54] [INFO] 
Accuracy por distancia:
[2025-11-22 15:27:54] [INFO]   Acc@1:  25.00%
[2025-11-22 15:27:54] [INFO]   Acc@5:  25.00%
[2025-11-22 15:27:54] [INFO]   Acc@10: 25.00%
[2025-11-22 15:27:54] [INFO]   Exact:  0.00%
[2025-11-22 15:27:54] [INFO] 
Clasificacion por severidad:
[2025-11-22 15:27:54] [INFO]   Accuracy: 50.00%
[2025-11-22 15:27:54] [INFO] 
  Por clase:
[2025-11-22 15:27:54] [INFO]     Very Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-11-22 15:27:54] [INFO]     Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-11-22 15:27:54] [INFO]     Moderate: Prec=33.33%, Rec=100.00%, F1=50.00%
[2025-11-22 15:27:54] [INFO]     Mild: Prec=100.00%, Rec=33.33%, F1=50.00%
[2025-11-22 15:27:54] [INFO] 
Generando graficos...
[2025-11-22 15:27:55] [INFO] Guardados: EVAL_ES_RAW_*.csv/png
[2025-11-22 15:27:55] [INFO] 
======================================================================
[2025-11-22 15:27:55] [INFO] EVALUACION: EVAL_ES_CALIBRATED
[2025-11-22 15:27:55] [INFO] ======================================================================
[2025-11-22 15:27:55] [INFO] Metricas de regresion:
[2025-11-22 15:27:55] [INFO]   MAE:        15.194
[2025-11-22 15:27:55] [INFO]   RMSE:       18.320
[2025-11-22 15:27:55] [INFO]   R²:         -4.529
[2025-11-22 15:27:55] [INFO]   Pearson r:  0.319 (p=0.6806)
[2025-11-22 15:27:55] [INFO]   Spearman:   0.211 (p=0.7892)
[2025-11-22 15:27:55] [INFO] 
Accuracy por distancia:
[2025-11-22 15:27:55] [INFO]   Acc@1:  0.00%
[2025-11-22 15:27:55] [INFO]   Acc@5:  25.00%
[2025-11-22 15:27:55] [INFO]   Acc@10: 50.00%
[2025-11-22 15:27:55] [INFO]   Exact:  0.00%
[2025-11-22 15:27:55] [INFO] 
Clasificacion por severidad:
[2025-11-22 15:27:55] [INFO]   Accuracy: 50.00%
[2025-11-22 15:27:55] [INFO] 
  Por clase:
[2025-11-22 15:27:55] [INFO]     Very Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-11-22 15:27:55] [INFO]     Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-11-22 15:27:55] [INFO]     Moderate: Prec=33.33%, Rec=100.00%, F1=50.00%
[2025-11-22 15:27:55] [INFO]     Mild: Prec=100.00%, Rec=33.33%, F1=50.00%
[2025-11-22 15:27:55] [INFO] 
Generando graficos...
[2025-11-22 15:27:55] [INFO] Guardados: EVAL_ES_CALIBRATED_*.csv/png
[2025-11-22 15:27:55] [INFO] 
======================================================================
[2025-11-22 15:27:55] [INFO] EVALUACION CATALÁN
[2025-11-22 15:27:55] [INFO] ======================================================================
[2025-11-22 15:27:55] [INFO] No hay datos en catalán para evaluar
[2025-11-22 15:27:55] [INFO] 
======================================================================
[2025-11-22 15:27:55] [INFO] PROCESO COMPLETADO
[2025-11-22 15:27:55] [INFO] ======================================================================
[2025-11-22 15:27:55] [INFO] Resultados guardados en: /lhome/ext/upc150/upc1503/afasia_cat/codigos_julio2025/outputs/experiments/resultados_svr/SVR_FINAL_20251122_152220_SFS_features
[2025-11-22 15:27:55] [INFO] 
Archivos generados:
[2025-11-22 15:27:55] [INFO]   - Modelo: model_final.pkl
[2025-11-22 15:27:55] [INFO]   - Calibrador: calibrator.pkl
[2025-11-22 15:27:55] [INFO]   - CV inglés: CV_PWA_*.csv/png
[2025-11-22 15:27:55] [INFO]   - CV calibrado: CV_PWA_CALIBRATED_*.csv/png
[2025-11-22 15:27:55] [INFO]   - Español: EVAL_ES_*.csv/png
[2025-11-22 15:27:55] [INFO]   - Interpretabilidad: feature_importance_*.csv/png
[2025-11-22 15:27:55] [INFO]   - SHAP: shap_values.csv, shap_summary_*.png
[2025-11-22 15:27:55] [INFO]   - Análisis de error: error_histogram.png, error_groups_analysis.csv
[2025-11-22 15:27:55] [INFO] 
======================================================================
[2025-11-22 15:27:55] [INFO] COMPARACIÓN CON LE ET AL. (2018)
[2025-11-22 15:27:55] [INFO] ======================================================================
[2025-11-22 15:27:55] [INFO] 
Resultados del paper (Table 9, Combined protocol):
[2025-11-22 15:27:55] [INFO]   MAE:        8.86 (Oracle) / 9.18 (Auto)
[2025-11-22 15:27:55] [INFO]   Correlación: .801 (Oracle) / .799 (Auto)
[2025-11-22 15:27:55] [INFO] 
Nuestros resultados (CV_PWA_CALIBRATED):
[2025-11-22 15:27:55] [INFO]   MAE:        12.31
[2025-11-22 15:27:55] [INFO]   Correlación: 0.724
[2025-11-22 15:27:55] [INFO] 
Diferencia con el paper:
[2025-11-22 15:27:55] [INFO]   ΔMAE:  +3.13 (peor)
[2025-11-22 15:27:55] [INFO]   ΔCorr: -0.075 (peor)
