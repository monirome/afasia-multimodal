[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] LGBM TRAINING - FULL_POSLM-BACKOFF_ZNORM-STD_STRATIFIED_OPTUNA-50
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] Output: /lhome/ext/upc150/upc1503/afasia_cat/codigos_julio2025/outputs/experiments/resultados_modelos/LGBM_20251221_103019_FULL_POSLM-BACKOFF_ZNORM-STD_STRATIFIED_OPTUNA-50
[2025-12-21 10:30:19] [INFO] Configuration:
[2025-12-21 10:30:19] [INFO]   Model:             LGBM
[2025-12-21 10:30:19] [INFO]   Features:          full
[2025-12-21 10:30:19] [INFO]   POS-LM method:     backoff
[2025-12-21 10:30:19] [INFO]   HPO method:        OPTUNA
[2025-12-21 10:30:19] [INFO]   Optuna trials:     50
[2025-12-21 10:30:19] [INFO]   CV inner folds:    3
[2025-12-21 10:30:19] [INFO]   Z-norm controls:   False
[2025-12-21 10:30:19] [INFO]   Stratified CV:     True
[2025-12-21 10:30:19] [INFO]   Dataset:           dataset_FINAL_CON_POSLM.csv
[2025-12-21 10:30:19] [INFO]   Exclude empty:     False
[2025-12-21 10:30:19] [INFO]   Notes:             BEST_1_LGBM_FULL_POSLM_Optuna50
[2025-12-21 10:30:19] [INFO]   SHAP:              disponible
[2025-12-21 10:30:19] [INFO]   Optuna:            disponible
[2025-12-21 10:30:19] [INFO] 
Config guardada: CONFIG.txt, config.json
[2025-12-21 10:30:19] [INFO] 
======================================================================
[2025-12-21 10:30:19] [INFO] CARGANDO DATOS
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] Total registros: 506
[2025-12-21 10:30:19] [INFO] 
Pacientes ES (TCU) antes del parche:
[2025-12-21 10:30:19] [INFO] 
patient_id language group   QA
    TCU02a       es   pwa 77.3
    TCU04a       es   pwa 83.8
    TCU06a       es   NaN 62.6
    TCU10a       es   NaN 77.6
[2025-12-21 10:30:19] [INFO] 
Pacientes ES (TCU) después del parche:
[2025-12-21 10:30:19] [INFO] 
patient_id language group   QA
    TCU02a       es   pwa 77.3
    TCU04a       es   pwa 83.8
    TCU06a       es   pwa 62.6
    TCU10a       es   pwa 77.6
[2025-12-21 10:30:19] [INFO] Con QA valido: 506
[2025-12-21 10:30:19] [INFO] 
Distribucion por idioma:
[2025-12-21 10:30:19] [INFO]   en: 502
[2025-12-21 10:30:19] [INFO]   es: 4
[2025-12-21 10:30:19] [INFO] 
======================================================================
[2025-12-21 10:30:19] [INFO] SPLIT
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] 
Split:
[2025-12-21 10:30:19] [INFO]   PWA:     423
[2025-12-21 10:30:19] [INFO]   Control: 70
[2025-12-21 10:30:19] [INFO] 
Sub-datasets extraídos de patient_id:
[2025-12-21 10:30:19] [INFO]   Total sub-datasets únicos: 26
[2025-12-21 10:30:19] [INFO]   Sub-datasets: acwt, adler, bu, cmu, elman, fridriksson, garrett, kansas, kempler, kurland, mba, mma, msu, scale, star, tap, tcu, thompson, tucson, umd, unh, unknown, whiteside, williamson, wozniak, wright
[2025-12-21 10:30:19] [INFO] 
  Distribución de pacientes por sub-dataset:
[2025-12-21 10:30:19] [INFO]     kurland: 63 pacientes
[2025-12-21 10:30:19] [INFO]     unknown: 56 pacientes
[2025-12-21 10:30:19] [INFO]     scale: 39 pacientes
[2025-12-21 10:30:19] [INFO]     williamson: 23 pacientes
[2025-12-21 10:30:19] [INFO]     tucson: 20 pacientes
[2025-12-21 10:30:19] [INFO]     kansas: 19 pacientes
[2025-12-21 10:30:19] [INFO]     fridriksson: 18 pacientes
[2025-12-21 10:30:19] [INFO]     tap: 18 pacientes
[2025-12-21 10:30:19] [INFO]     whiteside: 18 pacientes
[2025-12-21 10:30:19] [INFO]     adler: 18 pacientes
[2025-12-21 10:30:19] [INFO]     unh: 17 pacientes
[2025-12-21 10:30:19] [INFO]     elman: 15 pacientes
[2025-12-21 10:30:19] [INFO]     umd: 14 pacientes
[2025-12-21 10:30:19] [INFO]     thompson: 14 pacientes
[2025-12-21 10:30:19] [INFO]     msu: 13 pacientes
[2025-12-21 10:30:19] [INFO]     mma: 13 pacientes
[2025-12-21 10:30:19] [INFO]     acwt: 9 pacientes
[2025-12-21 10:30:19] [INFO]     wright: 7 pacientes
[2025-12-21 10:30:19] [INFO]     wozniak: 6 pacientes
[2025-12-21 10:30:19] [INFO]     tcu: 6 pacientes
[2025-12-21 10:30:19] [INFO]     bu: 6 pacientes
[2025-12-21 10:30:19] [INFO]     cmu: 2 pacientes
[2025-12-21 10:30:19] [INFO]     garrett: 2 pacientes
[2025-12-21 10:30:19] [INFO]     mba: 1 pacientes
[2025-12-21 10:30:19] [INFO]     star: 1 pacientes
[2025-12-21 10:30:19] [INFO]     kempler: 1 pacientes
[2025-12-21 10:30:19] [INFO] 
Por idioma (PWA):
[2025-12-21 10:30:19] [INFO]   EN (train): 419
[2025-12-21 10:30:19] [INFO]   ES (eval):  4
[2025-12-21 10:30:19] [INFO] 
======================================================================
[2025-12-21 10:30:19] [INFO] FEATURES
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] 
POS-LM método: backoff
[2025-12-21 10:30:19] [INFO]   Columnas POS-LM encontradas: 30
[2025-12-21 10:30:19] [INFO] 
======================================================================
[2025-12-21 10:30:19] [INFO] FEATURE SELECTION - FULL (ALL FEATURES)
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] Usando todas las features: 108
[2025-12-21 10:30:19] [INFO] 
Features:
[2025-12-21 10:30:19] [INFO]   DEN:   42
[2025-12-21 10:30:19] [INFO]   DYS:   22
[2025-12-21 10:30:19] [INFO]   LEX:   14
[2025-12-21 10:30:19] [INFO]   POSLM: 30
[2025-12-21 10:30:19] [INFO]   TOTAL: 108
[2025-12-21 10:30:19] [INFO] 
======================================================================
[2025-12-21 10:30:19] [INFO] CROSS-VALIDATION (EN) - StratifiedGroupKFold por sub-dataset
[2025-12-21 10:30:19] [INFO]   * Cada fold tiene 25% de pacientes de CADA sub-dataset
[2025-12-21 10:30:19] [INFO] Normalización: StandardScaler
[2025-12-21 10:30:19] [INFO] HPO: OPTUNA
[2025-12-21 10:30:19] [INFO] ======================================================================
[2025-12-21 10:30:19] [INFO] 
  Fold 1/4:
[2025-12-21 10:30:19] [INFO]     Train sub-datasets: {'kurland': 47, 'unknown': 41, 'scale': 29, 'williamson': 19, 'kansas': 14, 'tucson': 14, 'adler': 13, 'tap': 13, 'unh': 13, 'whiteside': 12, 'umd': 12, 'fridriksson': 12, 'thompson': 11, 'elman': 11, 'msu': 10, 'mma': 9, 'acwt': 7, 'wright': 5, 'bu': 5, 'wozniak': 5, 'tcu': 5, 'cmu': 2, 'garrett': 2, 'star': 1, 'kempler': 1}
[2025-12-21 10:30:19] [INFO]     Test sub-datasets:  {'kurland': 16, 'unknown': 15, 'scale': 10, 'fridriksson': 6, 'tucson': 6, 'whiteside': 6, 'kansas': 5, 'tap': 5, 'adler': 5, 'unh': 4, 'mma': 4, 'elman': 4, 'williamson': 4, 'msu': 3, 'thompson': 3, 'umd': 2, 'acwt': 2, 'wright': 2, 'bu': 1, 'mba': 1, 'tcu': 1, 'wozniak': 1}
[2025-12-21 10:30:19] [INFO]     Optimizando hiperparámetros con OPTUNA...
[2025-12-21 10:30:33] [INFO]     ✓ Optuna search space guardado: optuna_search_space.json
[2025-12-21 10:30:33] [INFO]     MAE: 11.875
[2025-12-21 10:30:33] [INFO]     Best params: {'num_leaves': 64, 'learning_rate': 0.029987127924801987, 'n_estimators': 272, 'min_child_samples': 21, 'subsample': 0.7106640209685551, 'colsample_bytree': 0.6436527204524957, 'reg_alpha': 4.470168157719058e-06, 'reg_lambda': 4.1749152100471845}
[2025-12-21 10:30:33] [INFO]     Trials/Combinations: 50
[2025-12-21 10:30:33] [INFO] 
  Fold 2/4:
[2025-12-21 10:30:33] [INFO]     Train sub-datasets: {'kurland': 47, 'unknown': 44, 'scale': 29, 'williamson': 17, 'tucson': 16, 'fridriksson': 15, 'whiteside': 14, 'kansas': 14, 'unh': 13, 'adler': 13, 'tap': 13, 'elman': 11, 'mma': 11, 'thompson': 9, 'msu': 9, 'umd': 8, 'tcu': 6, 'acwt': 5, 'wright': 5, 'wozniak': 5, 'bu': 5, 'cmu': 2, 'mba': 1, 'star': 1, 'garrett': 1, 'kempler': 1}
[2025-12-21 10:30:33] [INFO]     Test sub-datasets:  {'kurland': 16, 'unknown': 12, 'scale': 10, 'umd': 6, 'williamson': 6, 'tap': 5, 'thompson': 5, 'kansas': 5, 'adler': 5, 'tucson': 4, 'whiteside': 4, 'msu': 4, 'acwt': 4, 'unh': 4, 'elman': 4, 'fridriksson': 3, 'mma': 2, 'wright': 2, 'bu': 1, 'garrett': 1, 'wozniak': 1}
[2025-12-21 10:30:33] [INFO]     Optimizando hiperparámetros con OPTUNA...
[2025-12-21 10:30:50] [INFO]     MAE: 12.750
[2025-12-21 10:30:50] [INFO]     Best params: {'num_leaves': 73, 'learning_rate': 0.046476191061333334, 'n_estimators': 298, 'min_child_samples': 35, 'subsample': 0.7761042079978071, 'colsample_bytree': 0.7051978334426892, 'reg_alpha': 4.462459338217269e-08, 'reg_lambda': 0.00021834088501100496}
[2025-12-21 10:30:50] [INFO]     Trials/Combinations: 50
[2025-12-21 10:30:50] [INFO] 
  Fold 3/4:
[2025-12-21 10:30:50] [INFO]     Train sub-datasets: {'kurland': 48, 'unknown': 40, 'scale': 28, 'tap': 15, 'kansas': 15, 'williamson': 15, 'tucson': 15, 'adler': 14, 'whiteside': 14, 'fridriksson': 14, 'elman': 12, 'umd': 12, 'unh': 12, 'thompson': 11, 'msu': 10, 'mma': 9, 'acwt': 8, 'wright': 5, 'wozniak': 5, 'bu': 4, 'tcu': 3, 'mba': 1, 'star': 1, 'garrett': 1, 'kempler': 1}
[2025-12-21 10:30:50] [INFO]     Test sub-datasets:  {'unknown': 16, 'kurland': 15, 'scale': 11, 'williamson': 8, 'tucson': 5, 'unh': 5, 'mma': 4, 'kansas': 4, 'whiteside': 4, 'adler': 4, 'fridriksson': 4, 'thompson': 3, 'tcu': 3, 'elman': 3, 'msu': 3, 'tap': 3, 'wright': 2, 'bu': 2, 'umd': 2, 'cmu': 2, 'acwt': 1, 'garrett': 1, 'wozniak': 1}
[2025-12-21 10:30:50] [INFO]     Optimizando hiperparámetros con OPTUNA...
[2025-12-21 10:31:04] [INFO]     MAE: 12.634
[2025-12-21 10:31:04] [INFO]     Best params: {'num_leaves': 94, 'learning_rate': 0.06006100287958099, 'n_estimators': 270, 'min_child_samples': 10, 'subsample': 0.6646700594590177, 'colsample_bytree': 0.7534216998371411, 'reg_alpha': 3.09636244854352e-08, 'reg_lambda': 1.04859770105928e-05}
[2025-12-21 10:31:04] [INFO]     Trials/Combinations: 50
[2025-12-21 10:31:04] [INFO] 
  Fold 4/4:
[2025-12-21 10:31:04] [INFO]     Train sub-datasets: {'kurland': 47, 'unknown': 43, 'scale': 31, 'williamson': 18, 'tucson': 15, 'kansas': 14, 'whiteside': 14, 'adler': 14, 'tap': 13, 'fridriksson': 13, 'unh': 13, 'thompson': 11, 'elman': 11, 'mma': 10, 'msu': 10, 'umd': 10, 'acwt': 7, 'wright': 6, 'tcu': 4, 'bu': 4, 'wozniak': 3, 'garrett': 2, 'cmu': 2, 'mba': 1}
[2025-12-21 10:31:04] [INFO]     Test sub-datasets:  {'kurland': 16, 'unknown': 13, 'scale': 8, 'fridriksson': 5, 'kansas': 5, 'williamson': 5, 'tucson': 5, 'tap': 5, 'whiteside': 4, 'elman': 4, 'adler': 4, 'unh': 4, 'umd': 4, 'mma': 3, 'msu': 3, 'wozniak': 3, 'thompson': 3, 'acwt': 2, 'bu': 2, 'tcu': 2, 'kempler': 1, 'star': 1, 'wright': 1}
[2025-12-21 10:31:04] [INFO]     Optimizando hiperparámetros con OPTUNA...
[2025-12-21 10:31:20] [INFO]     MAE: 11.644
[2025-12-21 10:31:20] [INFO]     Best params: {'num_leaves': 50, 'learning_rate': 0.0825090670563093, 'n_estimators': 102, 'min_child_samples': 14, 'subsample': 0.7870141182390775, 'colsample_bytree': 0.894309529692765, 'reg_alpha': 0.3474018307963139, 'reg_lambda': 9.30533312811905e-08}
[2025-12-21 10:31:20] [INFO]     Trials/Combinations: 50
[2025-12-21 10:31:20] [INFO] 
Distribución de sub-datasets guardada
[2025-12-21 10:31:20] [INFO] 
======================================================================
[2025-12-21 10:31:20] [INFO] EVALUACION: CV_PWA
[2025-12-21 10:31:20] [INFO] ======================================================================
[2025-12-21 10:31:20] [INFO] Metricas de regresion:
[2025-12-21 10:31:20] [INFO]   MAE:        12.227
[2025-12-21 10:31:20] [INFO]   RMSE:       16.252
[2025-12-21 10:31:20] [INFO]   R²:         0.532
[2025-12-21 10:31:20] [INFO]   Pearson r:  0.736 (p=0.0000)
[2025-12-21 10:31:20] [INFO]   Spearman:   0.729 (p=0.0000)
[2025-12-21 10:31:20] [INFO] 
Accuracy por distancia:
[2025-12-21 10:31:20] [INFO]   Acc@1:  4.77%
[2025-12-21 10:31:20] [INFO]   Acc@5:  30.55%
[2025-12-21 10:31:20] [INFO]   Acc@10: 53.22%
[2025-12-21 10:31:20] [INFO]   Exact:  0.00%
[2025-12-21 10:31:20] [INFO] 
Clasificacion por severidad:
[2025-12-21 10:31:20] [INFO]   Accuracy: 57.28%
[2025-12-21 10:31:20] [INFO] 
  Por clase:
[2025-12-21 10:31:20] [INFO]     Very Severe: Prec=88.89%, Rec=18.18%, F1=30.19%
[2025-12-21 10:31:20] [INFO]     Severe: Prec=25.00%, Rec=32.73%, F1=28.35%
[2025-12-21 10:31:20] [INFO]     Moderate: Prec=54.01%, Rec=64.74%, F1=58.89%
[2025-12-21 10:31:20] [INFO]     Mild: Prec=74.83%, Rec=68.90%, F1=71.75%
[2025-12-21 10:31:20] [INFO] 
Generando graficos...
[2025-12-21 10:31:21] [INFO] Guardados: CV_PWA_*.csv/png
[2025-12-21 10:31:21] [INFO] 
======================================================================
[2025-12-21 10:31:21] [INFO] CALIBRACION
[2025-12-21 10:31:21] [INFO] ======================================================================
[2025-12-21 10:31:21] [INFO] 
======================================================================
[2025-12-21 10:31:21] [INFO] EVALUACION: CV_PWA_CALIBRATED
[2025-12-21 10:31:21] [INFO] ======================================================================
[2025-12-21 10:31:21] [INFO] Metricas de regresion:
[2025-12-21 10:31:21] [INFO]   MAE:        11.509
[2025-12-21 10:31:21] [INFO]   RMSE:       15.114
[2025-12-21 10:31:21] [INFO]   R²:         0.595
[2025-12-21 10:31:21] [INFO]   Pearson r:  0.772 (p=0.0000)
[2025-12-21 10:31:21] [INFO]   Spearman:   0.746 (p=0.0000)
[2025-12-21 10:31:21] [INFO] 
Accuracy por distancia:
[2025-12-21 10:31:21] [INFO]   Acc@1:  7.64%
[2025-12-21 10:31:21] [INFO]   Acc@5:  26.25%
[2025-12-21 10:31:21] [INFO]   Acc@10: 54.65%
[2025-12-21 10:31:21] [INFO]   Exact:  0.48%
[2025-12-21 10:31:21] [INFO] 
Clasificacion por severidad:
[2025-12-21 10:31:21] [INFO]   Accuracy: 56.32%
[2025-12-21 10:31:21] [INFO] 
  Por clase:
[2025-12-21 10:31:21] [INFO]     Very Severe: Prec=88.89%, Rec=18.18%, F1=30.19%
[2025-12-21 10:31:21] [INFO]     Severe: Prec=25.00%, Rec=30.91%, F1=27.64%
[2025-12-21 10:31:21] [INFO]     Moderate: Prec=51.75%, Rec=75.64%, F1=61.46%
[2025-12-21 10:31:21] [INFO]     Mild: Prec=81.58%, Rec=56.71%, F1=66.91%
[2025-12-21 10:31:21] [INFO] 
Generando graficos...
[2025-12-21 10:31:22] [INFO] Guardados: CV_PWA_CALIBRATED_*.csv/png
[2025-12-21 10:31:22] [INFO] 
======================================================================
[2025-12-21 10:31:22] [INFO] ANÁLISIS DE ERROR
[2025-12-21 10:31:22] [INFO] ======================================================================
[2025-12-21 10:31:22] [INFO] 
======================================================================
[2025-12-21 10:31:22] [INFO] ANÁLISIS POR GRUPOS DE ERROR (Threshold=5.316)
[2025-12-21 10:31:22] [INFO] ======================================================================
[2025-12-21 10:31:22] [INFO] 
Grupo Low Errors:
[2025-12-21 10:31:22] [INFO]   N:          121
[2025-12-21 10:31:22] [INFO]   MAE:        2.57 ± 1.64
[2025-12-21 10:31:22] [INFO]   QA real:    69.4 ± 16.1
[2025-12-21 10:31:22] [INFO] 
Grupo High Errors:
[2025-12-21 10:31:22] [INFO]   N:          298
[2025-12-21 10:31:22] [INFO]   MAE:        15.14 ± 9.39
[2025-12-21 10:31:22] [INFO]   QA real:    61.6 ± 25.9
[2025-12-21 10:31:22] [INFO] 
Diferencia en QA real entre grupos:
[2025-12-21 10:31:22] [INFO]   t-statistic: 3.682
[2025-12-21 10:31:22] [INFO]   p-value:     0.0003
[2025-12-21 10:31:22] [INFO] 
Guardado: error_histogram.png, error_groups_analysis.csv
[2025-12-21 10:31:22] [INFO] 
======================================================================
[2025-12-21 10:31:22] [INFO] MODELO FINAL
[2025-12-21 10:31:22] [INFO] ======================================================================
[2025-12-21 10:31:22] [INFO] Entrenando con: 419 PWA EN + 70 Control
[2025-12-21 10:31:22] [INFO] Optimizando modelo final con OPTUNA...
[2025-12-21 10:31:44] [INFO] Mejores parámetros:
[2025-12-21 10:31:44] [INFO]   num_leaves: 78
[2025-12-21 10:31:44] [INFO]   learning_rate: 0.045653104722483615
[2025-12-21 10:31:44] [INFO]   n_estimators: 106
[2025-12-21 10:31:44] [INFO]   min_child_samples: 39
[2025-12-21 10:31:44] [INFO]   subsample: 0.6227277433521733
[2025-12-21 10:31:44] [INFO]   colsample_bytree: 0.8458880811745431
[2025-12-21 10:31:44] [INFO]   reg_alpha: 9.832638361455777e-07
[2025-12-21 10:31:44] [INFO]   reg_lambda: 4.2845095906034854e-07
[2025-12-21 10:31:44] [INFO] Trials/Combinations: 50
[2025-12-21 10:31:44] [INFO] ✓ Mejores hiperparámetros guardados: best_params_final.csv/json
[2025-12-21 10:31:44] [INFO] 
======================================================================
[2025-12-21 10:31:44] [INFO] INTERPRETABILIDAD
[2025-12-21 10:31:44] [INFO] ======================================================================
[2025-12-21 10:31:44] [INFO] 
======================================================================
[2025-12-21 10:31:44] [INFO] PERMUTATION IMPORTANCE
[2025-12-21 10:31:44] [INFO] ======================================================================
[2025-12-21 10:31:44] [INFO] Calculando (n_repeats=10)...
[2025-12-21 10:31:46] [INFO] 
Top 20 features:
[2025-12-21 10:31:46] [INFO]    1. lex_phones_std                           2.6118 +/- 0.1211
[2025-12-21 10:31:46] [INFO]    2. den_determiners                          2.5252 +/- 0.1531
[2025-12-21 10:31:46] [INFO]    3. dys_long_pauses_per_min                  1.7581 +/- 0.2000
[2025-12-21 10:31:46] [INFO]    4. dys_pauses_per_min                       1.3146 +/- 0.1383
[2025-12-21 10:31:46] [INFO]    5. dys_fillers_per_min                      1.3089 +/- 0.1385
[2025-12-21 10:31:46] [INFO]    6. lex_ttr                                  1.0294 +/- 0.0693
[2025-12-21 10:31:46] [INFO]    7. poslm_bo_bigram_ce_mean                  0.8559 +/- 0.0722
[2025-12-21 10:31:46] [INFO]    8. dys_fillers_per_phone                    0.6981 +/- 0.0849
[2025-12-21 10:31:46] [INFO]    9. den_function_words                       0.5414 +/- 0.0529
[2025-12-21 10:31:46] [INFO]   10. den_prepositions                         0.5402 +/- 0.0641
[2025-12-21 10:31:46] [INFO]   11. dys_pause_sec_max                        0.5077 +/- 0.0295
[2025-12-21 10:31:46] [INFO]   12. dys_pause_sec_skew                       0.4336 +/- 0.0613
[2025-12-21 10:31:46] [INFO]   13. den_phones_utt_std                       0.4103 +/- 0.0487
[2025-12-21 10:31:46] [INFO]   14. lex_phones_skew                          0.3373 +/- 0.0631
[2025-12-21 10:31:46] [INFO]   15. den_noun_ratio                           0.3080 +/- 0.0461
[2025-12-21 10:31:46] [INFO]   16. den_phones_utt_skew                      0.2867 +/- 0.0352
[2025-12-21 10:31:46] [INFO]   17. den_verbs                                0.2745 +/- 0.0217
[2025-12-21 10:31:46] [INFO]   18. den_OCW                                  0.2573 +/- 0.0361
[2025-12-21 10:31:46] [INFO]   19. dys_pause_sec_mad                        0.2287 +/- 0.0258
[2025-12-21 10:31:46] [INFO]   20. den_phones_per_min                       0.2276 +/- 0.0280
[2025-12-21 10:31:46] [INFO] 
Guardado: feature_importance_permutation.csv/png
[2025-12-21 10:31:46] [INFO] 
======================================================================
[2025-12-21 10:31:46] [INFO] ANALISIS POR GRUPOS (Permutation)
[2025-12-21 10:31:46] [INFO] ======================================================================
[2025-12-21 10:31:46] [INFO] 
Importancia por grupo:
[2025-12-21 10:31:46] [INFO]   Grupo         Total      Media    Count    % Total
[2025-12-21 10:31:46] [INFO]   ------------------------------------------------------------
[2025-12-21 10:31:46] [INFO]   DYS          7.0264     0.3194       22      36.3%
[2025-12-21 10:31:46] [INFO]   DEN          6.9244     0.1649       42      35.8%
[2025-12-21 10:31:46] [INFO]   LEX          4.2793     0.3057       14      22.1%
[2025-12-21 10:31:46] [INFO]   POSLM        1.1070     0.0369       30       5.7%
[2025-12-21 10:31:47] [INFO] 
Guardado: feature_importance_by_group_permutation.csv/png
[2025-12-21 10:31:47] [INFO] 
======================================================================
[2025-12-21 10:31:47] [INFO] SHAP VALUES
[2025-12-21 10:31:47] [INFO] ======================================================================
[2025-12-21 10:31:47] [INFO] Calculando SHAP values...
[2025-12-21 10:31:47] [INFO]   Usando 50 samples random como background
[2025-12-21 10:31:47] [INFO]   Creando SHAP explainer...
[2025-12-21 10:31:47] [INFO]   Calculando SHAP para 20 samples de test...
[2025-12-21 10:31:49] [INFO] 
Top 20 features (SHAP):
[2025-12-21 10:31:49] [INFO]    1. dys_long_pauses_per_min                  4.1409
[2025-12-21 10:31:49] [INFO]    2. lex_phones_std                           3.9239
[2025-12-21 10:31:49] [INFO]    3. dys_pauses_per_min                       3.0153
[2025-12-21 10:31:49] [INFO]    4. den_determiners                          2.9573
[2025-12-21 10:31:49] [INFO]    5. dys_fillers_per_min                      1.7287
[2025-12-21 10:31:49] [INFO]    6. poslm_bo_bigram_ce_mean                  1.1300
[2025-12-21 10:31:49] [INFO]    7. dys_fillers_per_phone                    1.0715
[2025-12-21 10:31:49] [INFO]    8. den_phones_utt_std                       0.7121
[2025-12-21 10:31:49] [INFO]    9. den_prepositions                         0.6282
[2025-12-21 10:31:49] [INFO]   10. lex_ttr                                  0.6007
[2025-12-21 10:31:49] [INFO]   11. dys_pause_sec_max                        0.4540
[2025-12-21 10:31:49] [INFO]   12. den_phones_utt_skew                      0.4414
[2025-12-21 10:31:49] [INFO]   13. den_noun_ratio                           0.4256
[2025-12-21 10:31:49] [INFO]   14. dys_pause_sec_skew                       0.3550
[2025-12-21 10:31:49] [INFO]   15. den_function_words                       0.3527
[2025-12-21 10:31:49] [INFO]   16. lex_phones_skew                          0.3070
[2025-12-21 10:31:49] [INFO]   17. den_verbs                                0.2477
[2025-12-21 10:31:49] [INFO]   18. dys_short_pauses_per_min                 0.2458
[2025-12-21 10:31:49] [INFO]   19. den_phones_utt_median                    0.1401
[2025-12-21 10:31:49] [INFO]   20. dys_pause_sec_mad                        0.0959
[2025-12-21 10:31:49] [INFO] 
Generando graficos SHAP...
[2025-12-21 10:31:51] [INFO]   Guardado: shap_summary_*.png
[2025-12-21 10:31:51] [INFO] Guardado: shap_values.csv, feature_importance_shap.csv
[2025-12-21 10:31:51] [INFO] 
======================================================================
[2025-12-21 10:31:51] [INFO] ANALISIS POR GRUPOS (SHAP)
[2025-12-21 10:31:51] [INFO] ======================================================================
[2025-12-21 10:31:51] [INFO] 
Importancia por grupo:
[2025-12-21 10:31:51] [INFO]   Grupo         Total      Media    Count    % Total
[2025-12-21 10:31:51] [INFO]   ------------------------------------------------------------
[2025-12-21 10:31:51] [INFO]   DYS         11.1929     0.5088       22      48.3%
[2025-12-21 10:31:51] [INFO]   DEN          5.9583     0.1419       42      25.7%
[2025-12-21 10:31:51] [INFO]   LEX          4.8929     0.3495       14      21.1%
[2025-12-21 10:31:51] [INFO]   POSLM        1.1300     0.0377       30       4.9%
[2025-12-21 10:31:51] [INFO] 
Guardado: feature_importance_by_group_shap.csv/png
[2025-12-21 10:31:51] [INFO] 
======================================================================
[2025-12-21 10:31:51] [INFO] EVALUACION ESPAÑOL
[2025-12-21 10:31:51] [INFO] ======================================================================
[2025-12-21 10:31:51] [INFO] Evaluando 4 pacientes españoles...
[2025-12-21 10:31:51] [INFO] 
======================================================================
[2025-12-21 10:31:51] [INFO] EVALUACION: EVAL_ES_RAW
[2025-12-21 10:31:51] [INFO] ======================================================================
[2025-12-21 10:31:51] [INFO] Metricas de regresion:
[2025-12-21 10:31:51] [INFO]   MAE:        13.737
[2025-12-21 10:31:51] [INFO]   RMSE:       14.258
[2025-12-21 10:31:51] [INFO]   R²:         -2.349
[2025-12-21 10:31:51] [INFO]   Pearson r:  -0.861 (p=0.1387)
[2025-12-21 10:31:51] [INFO]   Spearman:   -0.800 (p=0.2000)
[2025-12-21 10:31:51] [INFO] 
Accuracy por distancia:
[2025-12-21 10:31:51] [INFO]   Acc@1:  0.00%
[2025-12-21 10:31:51] [INFO]   Acc@5:  0.00%
[2025-12-21 10:31:51] [INFO]   Acc@10: 25.00%
[2025-12-21 10:31:51] [INFO]   Exact:  0.00%
[2025-12-21 10:31:51] [INFO] 
Clasificacion por severidad:
[2025-12-21 10:31:51] [INFO]   Accuracy: 25.00%
[2025-12-21 10:31:51] [INFO] 
  Por clase:
[2025-12-21 10:31:51] [INFO]     Very Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:51] [INFO]     Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:51] [INFO]     Moderate: Prec=25.00%, Rec=100.00%, F1=40.00%
[2025-12-21 10:31:51] [INFO]     Mild: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:51] [INFO] 
Generando graficos...
[2025-12-21 10:31:52] [INFO] Guardados: EVAL_ES_RAW_*.csv/png
[2025-12-21 10:31:52] [INFO] 
======================================================================
[2025-12-21 10:31:52] [INFO] EVALUACION: EVAL_ES_CALIBRATED
[2025-12-21 10:31:52] [INFO] ======================================================================
[2025-12-21 10:31:52] [INFO] Metricas de regresion:
[2025-12-21 10:31:52] [INFO]   MAE:        14.420
[2025-12-21 10:31:52] [INFO]   RMSE:       15.359
[2025-12-21 10:31:52] [INFO]   R²:         -2.886
[2025-12-21 10:31:52] [INFO]   Pearson r:  -0.943 (p=0.0571)
[2025-12-21 10:31:52] [INFO]   Spearman:   -0.775 (p=0.2254)
[2025-12-21 10:31:52] [INFO] 
Accuracy por distancia:
[2025-12-21 10:31:52] [INFO]   Acc@1:  0.00%
[2025-12-21 10:31:52] [INFO]   Acc@5:  0.00%
[2025-12-21 10:31:52] [INFO]   Acc@10: 25.00%
[2025-12-21 10:31:52] [INFO]   Exact:  0.00%
[2025-12-21 10:31:52] [INFO] 
Clasificacion por severidad:
[2025-12-21 10:31:52] [INFO]   Accuracy: 25.00%
[2025-12-21 10:31:52] [INFO] 
  Por clase:
[2025-12-21 10:31:52] [INFO]     Very Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:52] [INFO]     Severe: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:52] [INFO]     Moderate: Prec=25.00%, Rec=100.00%, F1=40.00%
[2025-12-21 10:31:52] [INFO]     Mild: Prec=0.00%, Rec=0.00%, F1=0.00%
[2025-12-21 10:31:52] [INFO] 
Generando graficos...
[2025-12-21 10:31:52] [INFO] Guardados: EVAL_ES_CALIBRATED_*.csv/png
[2025-12-21 10:31:52] [INFO] 
======================================================================
[2025-12-21 10:31:52] [INFO] EVALUACION CATALÁN
[2025-12-21 10:31:52] [INFO] ======================================================================
[2025-12-21 10:31:52] [INFO] No hay datos en catalán para evaluar
[2025-12-21 10:31:52] [INFO] 
======================================================================
[2025-12-21 10:31:52] [INFO] PROCESO COMPLETADO
[2025-12-21 10:31:52] [INFO] ======================================================================
[2025-12-21 10:31:52] [INFO] Resultados guardados en: /lhome/ext/upc150/upc1503/afasia_cat/codigos_julio2025/outputs/experiments/resultados_modelos/LGBM_20251221_103019_FULL_POSLM-BACKOFF_ZNORM-STD_STRATIFIED_OPTUNA-50
[2025-12-21 10:31:52] [INFO] 
======================================================================
[2025-12-21 10:31:52] [INFO] REGISTRANDO EXPERIMENTO
[2025-12-21 10:31:52] [INFO] ======================================================================
[2025-12-21 10:31:52] [INFO] Experimento registrado
[2025-12-21 10:31:52] [INFO] 
======================================================================
[2025-12-21 10:31:52] [INFO] COMPARACIÓN CON LE ET AL. (2018)
[2025-12-21 10:31:52] [INFO] ======================================================================
[2025-12-21 10:31:52] [INFO] 
Resultados del paper:
[2025-12-21 10:31:52] [INFO]   MAE:        8.86 (Oracle) / 9.18 (Auto)
[2025-12-21 10:31:52] [INFO]   Correlación: .801 (Oracle) / .799 (Auto)
[2025-12-21 10:31:52] [INFO] 
Nuestros resultados (CV_PWA_CALIBRATED):
[2025-12-21 10:31:52] [INFO]   MAE:        11.51
[2025-12-21 10:31:52] [INFO]   Correlación: 0.772
[2025-12-21 10:31:52] [INFO] 
Diferencia con el paper:
[2025-12-21 10:31:52] [INFO]   ΔMAE:  +2.33 (peor)
[2025-12-21 10:31:52] [INFO]   ΔCorr: -0.027 (peor)
